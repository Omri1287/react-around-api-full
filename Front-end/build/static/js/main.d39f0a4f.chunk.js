(this.webpackJsonparound_react_app=this.webpackJsonparound_react_app||[]).push([[0],{30:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n(1),i=n.n(s),o=n(18),r=n.n(o),c=(n(30),n(22)),l=n(2),u=n.p+"static/media/header-icon.4e8e0a1d.svg",d=n(8);var m=function(e){return Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)("img",{className:"header__vector",src:u,alt:"around the usa logo"}),Object(a.jsxs)("div",{className:"header__nav",children:[Object(a.jsx)("p",{className:"header__email",children:e.userEmail}),Object(a.jsx)(d.b,{className:"header__link link",to:e.link,onClick:e.onClick,children:e.text})]})]})},j=i.a.createContext();var h=function(e){var t=i.a.useContext(j),n=e.owner._id===t._id,s="elements__item_delete ".concat(n?"elements__item_delete_show":"elements__item_delete_hidden"),o=e.likes.some((function(e){return e._id===t._id})),r="elements__heart ".concat(o?"elements__heart_active":"elements__heart");return Object(a.jsxs)("li",{className:"elements__item",children:[Object(a.jsx)("img",{className:"elements__image",src:e.src,alt:e.title,onClick:function(){e.handleCardClick(e.src,e.title)}}),Object(a.jsx)("button",{className:s,onClick:function(){e.handleDeleteClick(e.card)}}),Object(a.jsxs)("div",{id:"title-container",className:"elements__container",children:[Object(a.jsx)("h2",{className:"elements__title",children:e.title}),Object(a.jsxs)("div",{className:"elements__heart-container",children:[Object(a.jsx)("button",{type:"button",className:r,onClick:function(){e.handleCardLike(e.card)}}),Object(a.jsx)("p",{className:"elements__heart-count",children:e.likes.length})]})]})]})};var b=function(e){var t=i.a.useContext(j);return Object(a.jsxs)("main",{className:"content",children:[Object(a.jsx)(m,{link:"/signin",text:"Log out",onClick:e.handleLogout,userEmail:e.userEmail}),Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__avatar",children:[Object(a.jsx)("img",{src:t.avatar,alt:"profile picture",className:"profile__photo"}),Object(a.jsx)("button",{type:"button","aria-label":"edit-avatar",className:"profile__photo_edit",onClick:e.handleEditAvatarClick})]}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsxs)("div",{className:"profile__container",children:[Object(a.jsx)("h1",{className:"profile__text_name",children:t.name}),Object(a.jsx)("button",{className:"profile__edit-button",onClick:e.handleEditProfileClick})]}),Object(a.jsx)("h2",{className:"profile__text_desc",children:t.about})]}),Object(a.jsx)("button",{className:"profile__add-button",onClick:e.handleAddPlaceClick})]}),Object(a.jsx)("section",{className:"elements",children:Object(a.jsx)("ul",{className:"elements__list",children:e.cards.map((function(t,n){return Object(a.jsx)(h,{card:t,_id:t._id,src:t.link,title:t.name,likes:t.likes,owner:t.owner,handleCardClick:function(){e.handleCardClick(t.link,t.name)},handleDeleteClick:function(t){e.handleDeleteClick(t)},handleCardLike:function(t){e.handleCardLike(t)}},n)}))})})]})};var _=function(e){return Object(a.jsx)("div",{className:"modal modal_type_".concat(e.name," ").concat(e.isOpen?"modal_is-open":""),children:Object(a.jsxs)("div",{className:"modal__container",children:[Object(a.jsx)("button",{className:"modal__close-btn",onClick:e.onClose}),Object(a.jsxs)("form",{className:"modal__form modal__form_type_".concat(e.name),action:"#",noValidate:!0,onSubmit:e.onSubmit,children:[Object(a.jsx)("h2",{className:"modal__title",children:"".concat(e.title)}),e.children,Object(a.jsx)("button",{type:"submit",className:"modal__save modal__save_disabled",children:e.buttonText})]})]})})};var f=function(e){var t=i.a.useState(""),n=Object(l.a)(t,2),s=n[0],o=n[1],r=i.a.useState(""),c=Object(l.a)(r,2),u=c[0],d=c[1],m=i.a.useContext(j);return i.a.useEffect((function(){o(m.name),d(m.about)}),[m]),Object(a.jsxs)(_,{name:"edit-profile",title:"Edit Profile",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:s,about:u})},children:[Object(a.jsx)("input",{id:"profile-name",type:"text",defaultValue:s,placeholder:"title",className:"modal__input modal__input_name",name:"title",required:!0,maxLength:"40",minLength:"2",onChange:function(e){o(e.target.value)}}),Object(a.jsx)("span",{id:"profile-name-error",className:"modal__error"}),Object(a.jsx)("input",{id:"profile-desc",type:"text",defaultValue:u,placeholder:"description",className:"modal__input modal__input_desc",name:"desc",required:!0,maxLength:"200",minLength:"2",onChange:function(e){d(e.target.value)}}),Object(a.jsx)("span",{id:"profile-desc-error",className:"modal__error"})]})};var p=function(e){var t=i.a.useRef();return Object(a.jsxs)(_,{name:"edit-avatar",title:"Edit Avatar",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar(t.current.value)},children:[Object(a.jsx)("input",{id:"avatar-URL",type:"url",placeholder:"enter avatar link here",className:"modal__input modal__input_avatar-URL",name:"avatarURL",required:!0,minLength:"2",ref:t}),Object(a.jsx)("span",{id:"avatar-URL-error",className:"modal__error modal__error_visible"})]})};var O=function(e){return Object(a.jsx)(_,{name:"delete",buttonText:"Yes",title:"Are you sure?",isOpen:e.isOpen,onClose:e.onClose})};var g=function(e){var t=i.a.useState(""),n=Object(l.a)(t,2),s=n[0],o=n[1],r=i.a.useState(""),c=Object(l.a)(r,2),u=c[0],d=c[1];return Object(a.jsxs)(_,{name:"add-image",title:"New Place",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.handleAddPlaceSubmit({name:u,link:s})},children:[Object(a.jsx)("input",{id:"card-name",type:"text",placeholder:"Name",className:"modal__input modal__input_image-name",name:"name",onChange:function(e){d(e.target.value)},value:u,required:!0,maxLength:"30",minLength:"2"}),Object(a.jsx)("span",{id:"card-name-error",className:"modal__error"}),Object(a.jsx)("input",{id:"card-link",type:"url",placeholder:"image-link",className:"modal__input modal__input_url",name:"link",onChange:function(e){o(e.target.value)},value:s,required:!0}),Object(a.jsx)("span",{id:"card-link-error",className:"modal__error"})]})};var v=function(e){return Object(a.jsx)("div",{className:"modal modal_type_image ".concat(e.isOpen?"modal_is-open":""),children:Object(a.jsxs)("div",{className:"modal__container",children:[Object(a.jsx)("button",{className:"modal__close-btn",onClick:e.onClose}),Object(a.jsxs)("figure",{className:"modal__new-container",children:[Object(a.jsx)("img",{className:"modal__large-image",id:"img-large",src:e.link,alt:e.title}),Object(a.jsx)("figcaption",{className:"modal__caption",children:e.title})]})]})})},x=n(20),k=n(21),C=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(x.a)(this,e),this._baseUrl=n,this._headers=a}return Object(k.a)(e,[{key:"getCardList",value:function(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((function(e){if(e.ok)return e.json().then((function(e){return e}));Promise.reject("Error!"+e.statusText)}))}},{key:"getUserInfo",value:function(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}},{key:"getAppInfo",value:function(){return Promise.all([this.getUserInfo(),this.getCardList()])}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return fetch(this._baseUrl+"/cards",{headers:this._headers,method:"POST",body:JSON.stringify({name:t,link:n})}).then((function(e){if(e.ok)return e.json();Promise.reject("Error!"+e.statusText)}))}},{key:"removeCard",value:function(e){return fetch(this._baseUrl+"/cards/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}},{key:"addLike",value:function(e){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"PUT"}).then((function(e){if(e.ok)return e.json();Promise.reject("Error!"+e.statusText)}))}},{key:"deleteLike",value:function(e){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;return fetch(this._baseUrl+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText+e.status)}))}},{key:"setUserAvatar",value:function(e){var t=e.avatar;return fetch(this._baseUrl+"/users/me/avatar",{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}},{key:"setUserInfos",value:function(e){var t=e.name,n=e.about;return fetch(this._baseUrl+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-6",headers:{authorization:"2fafb99f-e5be-44a5-8ca2-7baac5014f21","Content-Type":"application/json"}}),N=n(3);var S=function(e){var t=e.handleRegistration,n=Object(s.useState)(""),i=Object(l.a)(n,2),o=i[0],r=i[1],c=Object(s.useState)(""),u=Object(l.a)(c,2),m=u[0],j=u[1],h=Object(s.useState)({}),b=Object(l.a)(h,2),_=(b[0],b[1],Object(N.g)());return Object(a.jsx)("div",{className:"login",children:Object(a.jsxs)("form",{action:"#",onSubmit:function(e){e.preventDefault(),t(o,m),localStorage.getItem("jwt")&&_.push("/signin")},className:"login__form",children:[Object(a.jsx)("h2",{className:"login__title",children:"Sign up"}),Object(a.jsx)("input",{required:!0,className:"login__form",name:"email",type:"email",value:o,placeholder:"email",onChange:function(e){return r(e.target.value)}}),Object(a.jsx)("input",{required:!0,className:"login__form",name:"password",type:"password",value:m,placeholder:"password",onChange:function(e){return j(e.target.value)}}),Object(a.jsx)("button",{type:"submit",className:"login__submit",children:"Sign up!"}),Object(a.jsx)(d.b,{to:"/signin",className:"login__signup",children:"Already a member? Log in here!"})]})})};var y=function(e){var t=Object(s.useState)(""),n=Object(l.a)(t,2),i=n[0],o=n[1],r=Object(s.useState)(""),c=Object(l.a)(r,2),u=c[0],m=c[1];function j(t){t.preventDefault(),e.handleLogin(u,i)}return Object(a.jsxs)("div",{className:"login",children:[Object(a.jsx)("div",{}),Object(a.jsxs)("form",{onSubmit:j,className:"login__form",children:[Object(a.jsx)("p",{className:"login__title",children:"Log in"}),Object(a.jsx)("input",{className:"login__form",required:!0,id:"email",name:"email",type:"email",value:u,placeholder:"Email",onChange:function(e){m(e.target.value)}}),Object(a.jsx)("input",{className:"login__form",required:!0,id:"password",name:"password",type:"password",value:i,placeholder:"Password",onChange:function(e){o(e.target.value)}}),Object(a.jsx)("button",{type:"submit",onSubmit:j,className:"login__submit",children:"Log in"}),Object(a.jsx)(d.b,{to:"signup",className:"login__signup",children:"Not a member yet? Sign up here!"})]})]})},E=n(23),L=n(24);var T=function(e){var t=e.component,n=Object(L.a)(e,["component"]);return Object(a.jsx)(N.b,{children:function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return console.log("args:",s),n.loggedIn?Object(a.jsx)(t,Object(E.a)({},n)):Object(a.jsx)(N.a,{to:"/signin"})}})},P=n.p+"static/media/Check.1b6082f8.svg",U=n.p+"static/media/Xerror.df8eddf6.svg";var w=function(e){return Object(a.jsxs)("div",{className:"modal__toolTip ".concat(e.isOpen?"modal__toolTip_visible":""),onClick:e.onClose,children:[Object(a.jsxs)("div",{className:"modal__content",children:[Object(a.jsx)("img",{className:"modal__icon",src:e.valid?P:U,alt:e.valid?"Check Mark":"Error"}),e.valid?Object(a.jsx)("p",{className:"modal__infotool-text",children:"Success! You have now been registered."}):Object(a.jsx)("p",{className:"modal__infotool-text",children:"Oops, something went wrong! Please try again"})]}),Object(a.jsx)("button",{className:"modal__close link",onClick:e.onClose})]})},A="https://register.nomoreparties.co",I=function(e){return fetch("".concat(A,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).then((function(e){return e}))};var D=function(){var e=i.a.useState([]),t=Object(l.a)(e,2),n=t[0],o=t[1],r=i.a.useState(!1),u=Object(l.a)(r,2),h=u[0],_=u[1],x=i.a.useState(!1),k=Object(l.a)(x,2),E=k[0],L=k[1],P=i.a.useState(!1),U=Object(l.a)(P,2),D=U[0],q=U[1],J=i.a.useState(!1),R=Object(l.a)(J,2),M=R[0],F=R[1],B=Object(s.useState)(!1),H=Object(l.a)(B,2),V=H[0],z=H[1],Y=i.a.useState(null),G=Object(l.a)(Y,2),X=G[0],K=G[1],Q=i.a.useState(""),W=Object(l.a)(Q,2),Z=W[0],$=W[1],ee=i.a.useState(""),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],se=i.a.useState({}),ie=Object(l.a)(se,2),oe=ie[0],re=ie[1],ce=i.a.useState(!1),le=Object(l.a)(ce,2),ue=le[0],de=le[1],me=i.a.useState(!1),je=Object(l.a)(me,2),he=(je[0],je[1]),be=Object(s.useState)(""),_e=Object(l.a)(be,2),fe=_e[0],pe=_e[1],Oe=i.a.useState(!1),ge=Object(l.a)(Oe,2),ve=ge[0],xe=ge[1],ke=i.a.useState(!1),Ce=Object(l.a)(ke,2),Ne=Ce[0],Se=Ce[1],ye=Object(N.g)();function Ee(){_(!1),F(!1),q(!1),L(!1),K(null),z(!1),xe(!1)}return i.a.useEffect((function(){!function(){var e=localStorage.getItem("jwt");e&&I(e).then((function(e){e.err&&console.log(e.err);var t=e.data.email;pe(t),de(!0),Se(!0)})).catch((function(e){return console.log(e)}))}()}),[]),i.a.useEffect((function(){C.getUserInfo().then((function(e){re(e)})).then((function(){C.getCardList().then((function(e){o(e.map((function(e){return{name:e.name,link:e.link,_id:e._id,likes:e.likes,owner:e.owner}})))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))}),[]),Object(s.useEffect)((function(){var e=localStorage.getItem("jwt");e&&I(e).then((function(e){var t={username:e.username,email:e.email};de(!0),he(t)}))}),[ue]),Object(a.jsx)("div",{className:"page",children:Object(a.jsx)(d.a,{children:Object(a.jsxs)(j.Provider,{value:oe,children:[Object(a.jsxs)(N.d,{children:[Object(a.jsx)(T,{exact:!0,path:"/",component:b,loggedIn:ue,handleLogout:function(){localStorage.removeItem("jwt"),de(!1),pe(""),ye.push("/signin")},email:fe,cards:n,editProfileModalOpen:h,editAvatarModalOpen:E,addImageModalOpen:D,deleteModalOpen:M,selectedCard:X,handleEditProfileClick:function(){_(!0)},handleEditAvatarClick:function(){L(!0)},handleAddPlaceClick:function(){q(!0)},handleDeleteClick:function(e){console.log(e),function(e){console.log(oe._id===e.owner._id),C.removeCard(e._id).then((function(){var t=n.filter((function(t){return t._id!==e._id}));o(t)})).catch((function(e){return console.log(e)}))}(e)},handleCardClick:function(e,t){z(!0),$(e),ae(t)},handleCardLike:function(e){!function(e){(!1===e.likes.some((function(e){return e._id===oe._id}))?C.addLike(e._id):C.deleteLike(e._id)).then((function(t){var a=n.map((function(n){return n._id===e._id?t:n}));o(a)})).catch((function(e){return console.log(e)}))}(e)}}),Object(a.jsxs)(N.b,{path:"/signin",children:[Object(a.jsx)(m,{link:"/signup",text:"Register",setEmail:pe}),ue?Object(a.jsx)(N.a,{to:"/"}):Object(a.jsx)(y,{handleLogin:function(e,t){(function(e,t){return fetch("".concat(A,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).then((function(e){return e.token?(localStorage.setItem("jwt",e.token),e):void 0}))})(e,t).then((function(t){if(!t)return console.log(!t),Se(!1),xe(!0),void ye.push("/signin");de(!0),pe(e),ye.push("/")})).catch((function(e){console.log(e),Se(!1),xe(!0)}))}})]}),Object(a.jsxs)(N.b,{path:"/signup",children:[Object(a.jsx)(m,{link:"/signin",text:"Login",setEmail:pe}),Object(a.jsx)(S,{handleRegistration:function(e,t){return function(e,t){return fetch("".concat(A,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})})}(e,t).then((function(e){if(201===e.status)return de(!0),ye.push("/signin"),Se(!0),void xe(!0);Se(!1),xe(!0)})).catch((function(e){return console.log(e)}))}})]})]}),Object(a.jsx)(f,{isOpen:h,onClose:Ee,onUpdateUser:function(e){var t=e.name,n=e.about;C.setUserInfo({name:t,about:n}).then((function(e){console.log(e),re(e)})).then((function(){_(!1)})).catch((function(e){return console.log(e)}))}}),Object(a.jsx)(p,{isOpen:E,onClose:Ee,onUpdateAvatar:function(e){C.setUserAvatar({avatar:e}).then((function(e){re(e)})).then((function(){L(!1)})).catch((function(e){return console.log(e)}))}}),Object(a.jsx)(g,{isOpen:D,onClose:Ee,handleAddPlaceSubmit:function(e){var t=e.name,a=e.link;C.addCard({name:t,link:a}).then((function(e){o([e].concat(Object(c.a)(n)))})).then((function(){return q(!1)})).catch((function(e){return console.log(e)}))}}),Object(a.jsx)(O,{isOpen:M,onClose:Ee}),Object(a.jsx)(v,{isOpen:V,onClose:Ee,link:Z,title:ne}),Object(a.jsx)(w,{isOpen:ve,onClose:Ee,valid:Ne})]})})})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),s(e),i(e),o(e)}))};r.a.render(Object(a.jsx)(d.a,{children:Object(a.jsx)(D,{})}),document.getElementById("root")),q()}},[[36,1,2]]]);
//# sourceMappingURL=main.d39f0a4f.chunk.js.map